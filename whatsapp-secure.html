<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Seguro - Criptografia RSA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsencrypt/3.3.2/jsencrypt.min.js"></script>
    <style>
        :root {
            --color-primary: #25D366;
            --color-secondary: #128C7E;
            --color-accent: #075E54;
            --color-bg: #f8f9fa;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #075E54 0%, #128C7E 50%, #25D366 100%);
        }
        
        .section-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .section-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .btn-primary {
            background: var(--color-secondary);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: var(--color-accent);
            transform: scale(1.02);
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .toast-success { background: #25D366; }
        .toast-error { background: #dc3545; }
        .toast-info { background: #17a2b8; }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid var(--color-secondary);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .code-block {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            word-break: break-all;
        }
        
        .nav-link {
            transition: all 0.2s ease;
        }
        
        .nav-link:hover {
            transform: translateY(-2px);
        }
        
        .nav-link.active {
            border-bottom: 3px solid var(--color-primary);
        }
        
        .fade-in {
            animation: fadeIn 0.4s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <svg class="w-10 h-10" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2C6.48 2 2 6.48 2 12c0 1.54.36 3 .97 4.29L2 22l5.71-.97C9 21.64 10.46 22 12 22c5.52 0 10-4.48 10-10S17.52 2 12 2zm0 18c-1.31 0-2.57-.3-3.71-.85l-.27-.15-2.76.47.47-2.76-.15-.27C5.3 14.57 5 13.31 5 12c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7z"/>
                        <path d="M16.5 13.5c-.25-.12-1.47-.73-1.69-.81-.23-.08-.39-.12-.56.12-.17.25-.64.81-.78.97-.14.17-.29.19-.54.06-.25-.12-1.05-.39-2-1.23-.74-.66-1.23-1.47-1.38-1.72-.14-.25-.02-.38.11-.51.11-.11.25-.29.37-.44.12-.14.17-.25.25-.42.08-.17.04-.31-.02-.44-.06-.12-.56-1.34-.76-1.84-.2-.48-.41-.42-.56-.43h-.48c-.17 0-.44.06-.67.31-.23.25-.89.87-.89 2.11 0 1.25.91 2.45 1.03 2.62.12.17 1.77 2.7 4.29 3.78.6.26 1.07.41 1.43.53.6.19 1.14.16 1.57.1.48-.07 1.47-.6 1.67-1.18.2-.58.2-1.08.14-1.18-.06-.1-.23-.17-.48-.29z"/>
                    </svg>
                    <div>
                        <h1 class="text-2xl font-bold">WhatsApp Seguro</h1>
                        <p class="text-sm text-green-100">Criptografia RSA 2048</p>
                    </div>
                </div>
                <button onclick="navigateTo('home')" class="px-4 py-2 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex space-x-1 overflow-x-auto">
                <button onclick="navigateTo('home')" class="nav-link px-4 py-4 text-sm font-medium text-gray-700 hover:text-green-600" data-section="home">
                    üè† Home
                </button>
                <button onclick="navigateTo('generate')" class="nav-link px-4 py-4 text-sm font-medium text-gray-700 hover:text-green-600" data-section="generate">
                    üîë Gerar Chaves
                </button>
                <button onclick="navigateTo('encrypt')" class="nav-link px-4 py-4 text-sm font-medium text-gray-700 hover:text-green-600" data-section="encrypt">
                    üîí Criptografar
                </button>
                <button onclick="navigateTo('test')" class="nav-link px-4 py-4 text-sm font-medium text-gray-700 hover:text-green-600" data-section="test">
                    üß™ Testar API
                </button>
                <button onclick="navigateTo('docs')" class="nav-link px-4 py-4 text-sm font-medium text-gray-700 hover:text-green-600" data-section="docs">
                    üìö Documenta√ß√£o
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Home Section -->
        <section id="home" class="section fade-in">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">Integra√ß√£o Segura com WhatsApp</h2>
                <p class="text-gray-600 mb-8">Demonstra√ß√£o educacional de criptografia assim√©trica RSA para prote√ß√£o de mensagens antes do envio para API do WhatsApp.</p>
                
                <!-- Flow Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="section-card bg-white rounded-xl shadow-md p-6 border-l-4 border-blue-500">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold text-xl mr-4">1</div>
                            <h3 class="text-xl font-semibold text-gray-800">Gerar Chaves</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Gerar par de chaves RSA (p√∫blica/privada) de 2048 bits.</p>
                        <button onclick="navigateTo('generate')" class="btn-primary text-white px-4 py-2 rounded-lg w-full">
                            Come√ßar ‚Üí
                        </button>
                    </div>
                    
                    <div class="section-card bg-white rounded-xl shadow-md p-6 border-l-4 border-green-500">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-green-600 font-bold text-xl mr-4">2</div>
                            <h3 class="text-xl font-semibold text-gray-800">Criptografar Mensagem</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Criptografar sua mensagem usando a chave p√∫blica.</p>
                        <button onclick="navigateTo('encrypt')" class="btn-primary text-white px-4 py-2 rounded-lg w-full">
                            Criptografar ‚Üí
                        </button>
                    </div>
                    
                    <div class="section-card bg-white rounded-xl shadow-md p-6 border-l-4 border-purple-500">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 font-bold text-xl mr-4">3</div>
                            <h3 class="text-xl font-semibold text-gray-800">Enviar para API</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Enviar mensagem criptografada para o endpoint seguro.</p>
                        <button onclick="navigateTo('test')" class="btn-primary text-white px-4 py-2 rounded-lg w-full">
                            Testar ‚Üí
                        </button>
                    </div>
                    
                    <div class="section-card bg-white rounded-xl shadow-md p-6 border-l-4 border-orange-500">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center text-orange-600 font-bold text-xl mr-4">4</div>
                            <h3 class="text-xl font-semibold text-gray-800">Descriptografar &amp; Enviar</h3>
                        </div>
                        <p class="text-gray-600 mb-4">Servidor descriptografa e envia para WhatsApp com seguran√ßa.</p>
                        <button onclick="navigateTo('docs')" class="btn-primary text-white px-4 py-2 rounded-lg w-full">
                            Documenta√ß√£o ‚Üí
                        </button>
                    </div>
                </div>
                
                <!-- Visual Flow Diagram -->
                <div class="bg-white rounded-xl shadow-md p-8 mb-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Fluxo de Seguran√ßa</h3>
                    <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0 md:space-x-4">
                        <div class="text-center">
                            <div class="w-20 h-20 bg-blue-500 rounded-full flex items-center justify-center text-white text-3xl mx-auto mb-2">üë§</div>
                            <p class="font-semibold text-gray-700">Cliente</p>
                            <p class="text-xs text-gray-500">Criptografa com<br>chave p√∫blica</p>
                        </div>
                        
                        <div class="flex items-center">
                            <svg class="w-12 h-12 text-gray-400 transform md:rotate-0 rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
                            </svg>
                        </div>
                        
                        <div class="text-center">
                            <div class="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center text-white text-3xl mx-auto mb-2">üîí</div>
                            <p class="font-semibold text-gray-700">Mensagem</p>
                            <p class="text-xs text-gray-500">Criptografada<br>em tr√¢nsito</p>
                        </div>
                        
                        <div class="flex items-center">
                            <svg class="w-12 h-12 text-gray-400 transform md:rotate-0 rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
                            </svg>
                        </div>
                        
                        <div class="text-center">
                            <div class="w-20 h-20 bg-purple-500 rounded-full flex items-center justify-center text-white text-3xl mx-auto mb-2">üñ•Ô∏è</div>
                            <p class="font-semibold text-gray-700">Servidor</p>
                            <p class="text-xs text-gray-500">Descriptografa com<br>chave privada</p>
                        </div>
                        
                        <div class="flex items-center">
                            <svg class="w-12 h-12 text-gray-400 transform md:rotate-0 rotate-90" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
                            </svg>
                        </div>
                        
                        <div class="text-center">
                            <div class="w-20 h-20 bg-orange-500 rounded-full flex items-center justify-center text-white text-3xl mx-auto mb-2">üí¨</div>
                            <p class="font-semibold text-gray-700">WhatsApp</p>
                            <p class="text-xs text-gray-500">Mensagem enviada<br>com seguran√ßa</p>
                        </div>
                    </div>
                </div>
                
                <!-- Security Notice -->
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded-lg">
                    <div class="flex items-start">
                        <svg class="w-6 h-6 text-yellow-600 mr-3 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                        </svg>
                        <div>
                            <h4 class="text-lg font-semibold text-yellow-800 mb-2">‚ö†Ô∏è Aplica√ß√£o Educacional</h4>
                            <p class="text-yellow-700">Esta √© uma demonstra√ß√£o para fins educacionais. A chave privada nunca deve ser exposta ou enviada pela rede. Em produ√ß√£o, mantenha a chave privada segura no servidor.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Generate Keys Section -->
        <section id="generate" class="section hidden fade-in">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">üîë Gera√ß√£o de Chaves RSA</h2>
                <p class="text-gray-600 mb-8">Gere um par de chaves RSA de 2048 bits para criptografia assim√©trica.</p>
                
                <div class="bg-white rounded-xl shadow-md p-8 mb-6">
                    <div class="text-center mb-6">
                        <button onclick="generateKeys()" id="generateBtn" class="btn-primary text-white px-8 py-4 rounded-lg text-lg font-semibold inline-flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/>
                            </svg>
                            Gerar Par de Chaves
                        </button>
                    </div>
                    
                    <div id="keysResult" class="hidden">
                        <div class="mb-6">
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-sm font-semibold text-gray-700">üîì Chave P√∫blica</label>
                                <button onclick="copyToClipboard('publicKeyText', 'Chave p√∫blica copiada!')" class="text-sm text-green-600 hover:text-green-700 font-medium flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                                    </svg>
                                    Copiar
                                </button>
                            </div>
                            <textarea id="publicKeyText" readonly class="w-full h-32 p-3 border border-gray-300 rounded-lg bg-gray-50 font-mono text-xs" placeholder="A chave p√∫blica aparecer√° aqui..."></textarea>
                            <p class="text-xs text-gray-500 mt-2">‚úÖ Compartilhe esta chave com quem for criptografar mensagens</p>
                        </div>
                        
                        <div class="mb-6">
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-sm font-semibold text-gray-700">üîê Chave Privada</label>
                                <button onclick="copyToClipboard('privateKeyText', 'Chave privada copiada!')" class="text-sm text-green-600 hover:text-green-700 font-medium flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                                    </svg>
                                    Copiar
                                </button>
                            </div>
                            <textarea id="privateKeyText" readonly class="w-full h-32 p-3 border border-gray-300 rounded-lg bg-gray-50 font-mono text-xs" placeholder="A chave privada aparecer√° aqui..."></textarea>
                            <p class="text-xs text-red-500 mt-2">‚ö†Ô∏è NUNCA compartilhe esta chave! Guarde em local seguro.</p>
                        </div>
                        
                        <div class="bg-red-50 border-l-4 border-red-400 p-4 rounded">
                            <div class="flex items-start">
                                <svg class="w-5 h-5 text-red-600 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-red-800">Seguran√ßa da Chave Privada</h4>
                                    <p class="text-sm text-red-700">A chave privada deve ser mantida em segredo absoluto. Em ambiente de produ√ß√£o, ela deve ficar apenas no servidor, nunca sendo exposta ao cliente.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-6 text-center">
                            <button onclick="navigateTo('encrypt')" class="btn-primary text-white px-6 py-3 rounded-lg inline-flex items-center">
                                Pr√≥ximo: Criptografar Mensagem
                                <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="bg-blue-50 border-l-4 border-blue-400 p-6 rounded-lg">
                    <h4 class="font-semibold text-blue-800 mb-2">‚ÑπÔ∏è Como funciona?</h4>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li>‚Ä¢ RSA usa um par de chaves: uma p√∫blica (para criptografar) e uma privada (para descriptografar)</li>
                        <li>‚Ä¢ O tamanho da chave (2048 bits) determina o n√≠vel de seguran√ßa</li>
                        <li>‚Ä¢ Mensagens criptografadas com a chave p√∫blica s√≥ podem ser descriptografadas com a chave privada</li>
                        <li>‚Ä¢ Este m√©todo garante que apenas o detentor da chave privada possa ler as mensagens</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Encrypt Message Section -->
        <section id="encrypt" class="section hidden fade-in">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">üîí Criptografar Mensagem</h2>
                <p class="text-gray-600 mb-8">Criptografe sua mensagem usando a chave p√∫blica RSA.</p>
                
                <div class="bg-white rounded-xl shadow-md p-8 mb-6">
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">üìù Mensagem</label>
                        <textarea id="messageToEncrypt" class="w-full h-32 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="Digite a mensagem que deseja criptografar..."></textarea>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">üîì Chave P√∫blica</label>
                        <textarea id="publicKeyForEncrypt" class="w-full h-32 p-3 border border-gray-300 rounded-lg bg-gray-50 font-mono text-xs focus:ring-2 focus:ring-green-500 focus:border-transparent" placeholder="Cole a chave p√∫blica aqui..."></textarea>
                    </div>
                    
                    <div class="text-center mb-6">
                        <button onclick="encryptMessage()" id="encryptBtn" class="btn-primary text-white px-8 py-3 rounded-lg font-semibold inline-flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                            </svg>
                            Criptografar
                        </button>
                    </div>
                    
                    <div id="encryptResult" class="hidden">
                        <div class="mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-sm font-semibold text-gray-700">üîê Mensagem Criptografada (Base64)</label>
                                <button onclick="copyToClipboard('encryptedMessage', 'Mensagem criptografada copiada!')" class="text-sm text-green-600 hover:text-green-700 font-medium flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                                    </svg>
                                    Copiar
                                </button>
                            </div>
                            <textarea id="encryptedMessage" readonly class="w-full h-40 p-3 border border-gray-300 rounded-lg bg-gray-50 font-mono text-xs"></textarea>
                            <p class="text-xs text-gray-500 mt-2">‚úÖ Esta mensagem criptografada pode ser enviada com seguran√ßa</p>
                        </div>
                        
                        <div class="bg-green-50 border-l-4 border-green-400 p-4 rounded mb-4">
                            <div class="flex items-start">
                                <svg class="w-5 h-5 text-green-600 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-green-800">Criptografia realizada com sucesso!</h4>
                                    <p class="text-sm text-green-700">A mensagem foi criptografada e pode ser transmitida com seguran√ßa. Apenas quem possui a chave privada poder√° descriptograf√°-la.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center">
                            <button onclick="navigateTo('test')" class="btn-primary text-white px-6 py-3 rounded-lg inline-flex items-center">
                                Pr√≥ximo: Testar API
                                <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="bg-blue-50 border-l-4 border-blue-400 p-6 rounded-lg">
                    <h4 class="font-semibold text-blue-800 mb-2">üí° Dica</h4>
                    <p class="text-sm text-blue-700">A mensagem criptografada est√° codificada em Base64 para facilitar a transmiss√£o. O tamanho da mensagem original n√£o pode exceder o tamanho da chave menos o padding (aproximadamente 245 bytes para RSA-2048).</p>
                </div>
            </div>
        </section>

        <!-- Test API Section -->
        <section id="test" class="section hidden fade-in">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">üß™ Teste de API</h2>
                <p class="text-gray-600 mb-8">Simule o envio da mensagem criptografada para o endpoint de API e veja a descriptografia.</p>
                
                <div class="bg-white rounded-xl shadow-md p-8 mb-6">
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">üîê Mensagem Criptografada</label>
                        <textarea id="encryptedMessageForTest" class="w-full h-32 p-3 border border-gray-300 rounded-lg bg-gray-50 font-mono text-xs focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Cole a mensagem criptografada aqui..."></textarea>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">üîê Chave Privada (para descriptografia no servidor)</label>
                        <textarea id="privateKeyForTest" class="w-full h-32 p-3 border border-gray-300 rounded-lg bg-gray-50 font-mono text-xs focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Cole a chave privada aqui..."></textarea>
                        <p class="text-xs text-red-500 mt-2">‚ö†Ô∏è Lembre-se: em produ√ß√£o, a chave privada fica apenas no servidor!</p>
                    </div>
                    
                    <div class="text-center mb-6">
                        <button onclick="testAPI()" id="testBtn" class="btn-primary text-white px-8 py-3 rounded-lg font-semibold inline-flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                            Simular Envio
                        </button>
                    </div>
                    
                    <div id="testResult" class="hidden">
                        <div class="bg-gray-800 text-gray-100 rounded-lg p-6 mb-4 font-mono text-sm">
                            <div class="mb-4">
                                <div class="text-yellow-400 mb-2">üì§ REQUEST:</div>
                                <div class="pl-4 text-xs">
                                    <div class="mb-1"><span class="text-blue-400">POST</span> /api/whatsapp/send</div>
                                    <div class="mb-1"><span class="text-gray-400">Content-Type:</span> application/json</div>
                                    <div class="bg-gray-900 p-2 rounded mt-2 overflow-x-auto">
                                        <pre id="requestLog"></pre>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <div class="text-green-400 mb-2">üì• RESPONSE:</div>
                                <div class="pl-4 text-xs">
                                    <div class="mb-1"><span class="text-green-400">200</span> OK</div>
                                    <div class="bg-gray-900 p-2 rounded mt-2 overflow-x-auto">
                                        <pre id="responseLog"></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-green-50 border-l-4 border-green-400 p-4 rounded mb-4">
                            <div class="flex items-start">
                                <svg class="w-5 h-5 text-green-600 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-green-800">Descriptografia realizada!</h4>
                                    <p class="text-sm text-green-700">O servidor descriptografou a mensagem com sucesso usando a chave privada e simulou o envio para WhatsApp.</p>
                                    <div class="mt-2 p-3 bg-white rounded border border-green-200">
                                        <div class="text-xs text-gray-600 mb-1">Mensagem Descriptografada:</div>
                                        <div id="decryptedMessageDisplay" class="font-semibold text-gray-800"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center">
                            <button onclick="navigateTo('docs')" class="btn-primary text-white px-6 py-3 rounded-lg inline-flex items-center">
                                Ver Documenta√ß√£o Completa
                                <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="bg-purple-50 border-l-4 border-purple-400 p-6 rounded-lg">
                    <h4 class="font-semibold text-purple-800 mb-2">üîÑ Fluxo Simulado</h4>
                    <ol class="text-sm text-purple-700 space-y-1 list-decimal list-inside">
                        <li>Cliente envia mensagem criptografada via POST</li>
                        <li>Servidor recebe e valida o payload</li>
                        <li>Servidor descriptografa usando chave privada</li>
                        <li>Servidor valida e envia para API do WhatsApp</li>
                        <li>Servidor retorna confirma√ß√£o ao cliente</li>
                    </ol>
                </div>
            </div>
        </section>

        <!-- Documentation Section -->
        <section id="docs" class="section hidden fade-in">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">üìö Documenta√ß√£o</h2>
                <p class="text-gray-600 mb-8">Guia completo de implementa√ß√£o e melhores pr√°ticas de seguran√ßa.</p>
                
                <!-- Overview -->
                <div class="bg-white rounded-xl shadow-md p-8 mb-6">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üéØ Vis√£o Geral</h3>
                    <p class="text-gray-700 mb-4">Esta aplica√ß√£o demonstra uma arquitetura de integra√ß√£o segura com WhatsApp usando criptografia assim√©trica RSA-2048. O objetivo √© proteger as mensagens durante o tr√¢nsito entre o cliente e o servidor.</p>
                    
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-blue-800 mb-2">Por que usar criptografia RSA?</h4>
                        <ul class="text-sm text-blue-700 space-y-1">
                            <li>‚úÖ Protege dados sens√≠veis em tr√¢nsito</li>
                            <li>‚úÖ Impede intercepta√ß√£o de mensagens</li>
                            <li>‚úÖ Garante que apenas o servidor possa ler as mensagens</li>
                            <li>‚úÖ Adiciona camada extra de seguran√ßa al√©m do HTTPS</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Architecture -->
                <div class="bg-white rounded-xl shadow-md p-8 mb-6">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üèóÔ∏è Arquitetura</h3>
                    <div class="mb-4">
                        <h4 class="font-semibold text-gray-800 mb-2">Cliente (Frontend)</h4>
                        <ul class="text-gray-700 space-y-1 text-sm">
                            <li>‚Ä¢ Recebe a chave p√∫blica do servidor</li>
                            <li>‚Ä¢ Criptografa mensagens localmente usando JSEncrypt</li>
                            <li>‚Ä¢ Envia mensagem criptografada via API REST</li>
                            <li>‚Ä¢ Nunca tem acesso √† chave privada</li>
                        </ul>
                    </div>
                    
                    <div class="mb-4">
                        <h4 class="font-semibold text-gray-800 mb-2">Servidor (Backend)</h4>
                        <ul class="text-gray-700 space-y-1 text-sm">
                            <li>‚Ä¢ Mant√©m a chave privada em seguran√ßa (vari√°vel de ambiente)</li>
                            <li>‚Ä¢ Recebe mensagem criptografada do cliente</li>
                            <li>‚Ä¢ Descriptografa usando a chave privada</li>
                            <li>‚Ä¢ Valida e processa a mensagem</li>
                            <li>‚Ä¢ Envia para API oficial do WhatsApp</li>
                        </ul>
                    </div>
                    
                    <div class="bg-gray-100 p-4 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-2">Exemplo de Endpoint (Node.js)</h4>
                        <pre class="code-block text-xs overflow-x-auto">const express = require('express');
const NodeRSA = require('node-rsa');
const axios = require('axios');

const app = express();
app.use(express.json());

// Carregar chave privada de vari√°vel de ambiente
const privateKey = new NodeRSA(process.env.RSA_PRIVATE_KEY);

app.post('/api/whatsapp/send', async (req, res) => {
  try {
    const { encryptedMessage, recipient } = req.body;
    
    // Descriptografar mensagem
    const decryptedMessage = privateKey.decrypt(encryptedMessage, 'utf8');
    
    // Validar mensagem
    if (!decryptedMessage || decryptedMessage.length === 0) {
      return res.status(400).json({ error: 'Invalid message' });
    }
    
    // Enviar para WhatsApp API
    const whatsappResponse = await axios.post(
      'https://api.whatsapp.com/send',
      {
        to: recipient,
        message: decryptedMessage
      },
      {
        headers: {
          'Authorization': `Bearer ${process.env.WHATSAPP_TOKEN}`
        }
      }
    );
    
    res.json({
      success: true,
      messageId: whatsappResponse.data.id
    });
    
  } catch (error) {
    console.error('Error:', error);
    res.status(500).json({ error: 'Failed to send message' });
  }
});

app.listen(3000);</pre>
                    </div>
                </div>
                
                <!-- Best Practices -->
                <div class="bg-white rounded-xl shadow-md p-8 mb-6">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üõ°Ô∏è Boas Pr√°ticas de Seguran√ßa</h3>
                    
                    <div class="space-y-4">
                        <div class="border-l-4 border-green-500 pl-4">
                            <h4 class="font-semibold text-gray-800 mb-1">1. Prote√ß√£o da Chave Privada</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚úì Armazene em vari√°veis de ambiente</li>
                                <li>‚úì Nunca comite no c√≥digo fonte</li>
                                <li>‚úì Use secrets managers (AWS Secrets, Azure Key Vault)</li>
                                <li>‚úì Implemente rota√ß√£o peri√≥dica de chaves</li>
                            </ul>
                        </div>
                        
                        <div class="border-l-4 border-blue-500 pl-4">
                            <h4 class="font-semibold text-gray-800 mb-1">2. Comunica√ß√£o Segura</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚úì Sempre use HTTPS em produ√ß√£o</li>
                                <li>‚úì Implemente certificados SSL/TLS v√°lidos</li>
                                <li>‚úì Configure CORS adequadamente</li>
                                <li>‚úì Use headers de seguran√ßa (HSTS, CSP)</li>
                            </ul>
                        </div>
                        
                        <div class="border-l-4 border-purple-500 pl-4">
                            <h4 class="font-semibold text-gray-800 mb-1">3. Valida√ß√£o e Sanitiza√ß√£o</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚úì Valide todos os inputs do cliente</li>
                                <li>‚úì Sanitize mensagens descriptografadas</li>
                                <li>‚úì Implemente rate limiting</li>
                                <li>‚úì Registre todas as tentativas de acesso</li>
                            </ul>
                        </div>
                        
                        <div class="border-l-4 border-orange-500 pl-4">
                            <h4 class="font-semibold text-gray-800 mb-1">4. Monitoramento e Auditoria</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚úì Log todas as opera√ß√µes cr√≠ticas</li>
                                <li>‚úì Configure alertas de seguran√ßa</li>
                                <li>‚úì Monitore tentativas de acesso inv√°lidas</li>
                                <li>‚úì Realize auditorias peri√≥dicas</li>
                            </ul>
                        </div>
                        
                        <div class="border-l-4 border-red-500 pl-4">
                            <h4 class="font-semibold text-gray-800 mb-1">5. Limita√ß√µes do RSA</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚ö†Ô∏è Mensagens limitadas a ~245 bytes (RSA-2048)</li>
                                <li>‚ö†Ô∏è Para mensagens maiores, use criptografia h√≠brida</li>
                                <li>‚ö†Ô∏è RSA √© mais lento que algoritmos sim√©tricos</li>
                                <li>‚ö†Ô∏è Considere AES para mensagens grandes</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Production Integration -->
                <div class="bg-white rounded-xl shadow-md p-8 mb-6">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üöÄ Integra√ß√£o em Produ√ß√£o</h3>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold text-gray-800 mb-2">Passo 1: Configurar Ambiente</h4>
                        <pre class="code-block text-xs"># .env
RSA_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"
WHATSAPP_API_TOKEN="seu_token_aqui"
WHATSAPP_API_URL="https://api.whatsapp.com/v1"
NODE_ENV="production"</pre>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold text-gray-800 mb-2">Passo 2: Implementar Cliente</h4>
                        <pre class="code-block text-xs">// client.js
import JSEncrypt from 'jsencrypt';

class WhatsAppSecureClient {
  constructor(publicKey) {
    this.encrypt = new JSEncrypt();
    this.encrypt.setPublicKey(publicKey);
  }
  
  async sendMessage(message, recipient) {
    // Criptografar mensagem
    const encryptedMessage = this.encrypt.encrypt(message);
    
    // Enviar para API
    const response = await fetch('/api/whatsapp/send', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        encryptedMessage,
        recipient
      })
    });
    
    return response.json();
  }
}

// Uso
const client = new WhatsAppSecureClient(PUBLIC_KEY);
await client.sendMessage('Ol√°!', '+5511999999999');</pre>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold text-gray-800 mb-2">Passo 3: Deploy Seguro</h4>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li>‚Ä¢ Configure firewall e security groups</li>
                            <li>‚Ä¢ Use WAF (Web Application Firewall)</li>
                            <li>‚Ä¢ Implemente CDN com prote√ß√£o DDoS</li>
                            <li>‚Ä¢ Configure backup autom√°tico das chaves</li>
                            <li>‚Ä¢ Teste recupera√ß√£o de desastres</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Resources -->
                <div class="bg-gradient-to-r from-green-50 to-blue-50 rounded-xl shadow-md p-8">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-4">üìñ Recursos Adicionais</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white p-4 rounded-lg shadow-sm">
                            <h4 class="font-semibold text-gray-800 mb-2">üìö Documenta√ß√£o</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">WhatsApp Business API</a></li>
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">JSEncrypt Library</a></li>
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">Node RSA</a></li>
                            </ul>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg shadow-sm">
                            <h4 class="font-semibold text-gray-800 mb-2">üîê Seguran√ßa</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">OWASP Top 10</a></li>
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">RSA Algorithm</a></li>
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">TLS/SSL Best Practices</a></li>
                            </ul>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg shadow-sm">
                            <h4 class="font-semibold text-gray-800 mb-2">üõ†Ô∏è Ferramentas</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">Postman API Testing</a></li>
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">SSL Labs Test</a></li>
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">Security Headers</a></li>
                            </ul>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg shadow-sm">
                            <h4 class="font-semibold text-gray-800 mb-2">üí¨ Comunidade</h4>
                            <ul class="text-sm text-gray-700 space-y-1">
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">Stack Overflow</a></li>
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">GitHub Discussions</a></li>
                                <li>‚Ä¢ <a href="#" class="text-green-600 hover:underline">Dev Community</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="gradient-bg text-white mt-16 py-8">
        <div class="container mx-auto px-4 text-center">
            <p class="text-sm">¬© 2025 WhatsApp Seguro - Demonstra√ß√£o Educacional</p>
            <p class="text-xs text-green-100 mt-2">Esta aplica√ß√£o √© apenas para fins educacionais e demonstra conceitos de criptografia RSA</p>
        </div>
    </footer>

    <script>
        // Application State
        let appState = {
            publicKey: '',
            privateKey: '',
            encryptedMessage: '',
            currentSection: 'home'
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            navigateTo('home');
        });

        // Navigation
        function navigateTo(section) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(sec => {
                sec.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(section);
            if (targetSection) {
                targetSection.classList.remove('hidden');
                targetSection.classList.add('fade-in');
            }
            
            // Update navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            const activeLink = document.querySelector(`[data-section="${section}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            // Update state
            appState.currentSection = section;
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Toast Notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Generate RSA Keys
        function generateKeys() {
            const btn = document.getElementById('generateBtn');
            btn.disabled = true;
            btn.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>Gerando...';
            
            setTimeout(() => {
                try {
                    const crypt = new JSEncrypt({ default_key_size: 2048 });
                    
                    appState.publicKey = crypt.getPublicKey();
                    appState.privateKey = crypt.getPrivateKey();
                    
                    document.getElementById('publicKeyText').value = appState.publicKey;
                    document.getElementById('privateKeyText').value = appState.privateKey;
                    
                    document.getElementById('keysResult').classList.remove('hidden');
                    
                    showToast('Chaves geradas com sucesso!', 'success');
                    
                    btn.disabled = false;
                    btn.innerHTML = '<svg class="w-6 h-6 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/></svg>Gerar Par de Chaves';
                } catch (error) {
                    showToast('Erro ao gerar chaves: ' + error.message, 'error');
                    btn.disabled = false;
                    btn.innerHTML = '<svg class="w-6 h-6 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/></svg>Gerar Par de Chaves';
                }
            }, 500);
        }

        // Encrypt Message
        function encryptMessage() {
            const message = document.getElementById('messageToEncrypt').value.trim();
            const publicKey = document.getElementById('publicKeyForEncrypt').value.trim();
            
            if (!message) {
                showToast('Por favor, digite uma mensagem', 'error');
                return;
            }
            
            if (!publicKey) {
                showToast('Por favor, cole a chave p√∫blica', 'error');
                return;
            }
            
            const btn = document.getElementById('encryptBtn');
            btn.disabled = true;
            btn.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>Criptografando...';
            
            setTimeout(() => {
                try {
                    const encrypt = new JSEncrypt();
                    encrypt.setPublicKey(publicKey);
                    
                    const encrypted = encrypt.encrypt(message);
                    
                    if (!encrypted) {
                        throw new Error('Falha na criptografia. Verifique a chave p√∫blica.');
                    }
                    
                    appState.encryptedMessage = encrypted;
                    document.getElementById('encryptedMessage').value = encrypted;
                    document.getElementById('encryptResult').classList.remove('hidden');
                    
                    showToast('Mensagem criptografada com sucesso!', 'success');
                    
                    btn.disabled = false;
                    btn.innerHTML = '<svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>Criptografar';
                } catch (error) {
                    showToast('Erro ao criptografar: ' + error.message, 'error');
                    btn.disabled = false;
                    btn.innerHTML = '<svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>Criptografar';
                }
            }, 300);
        }

        // Test API
        function testAPI() {
            const encryptedMessage = document.getElementById('encryptedMessageForTest').value.trim();
            const privateKey = document.getElementById('privateKeyForTest').value.trim();
            
            if (!encryptedMessage) {
                showToast('Por favor, cole a mensagem criptografada', 'error');
                return;
            }
            
            if (!privateKey) {
                showToast('Por favor, cole a chave privada', 'error');
                return;
            }
            
            const btn = document.getElementById('testBtn');
            btn.disabled = true;
            btn.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>Processando...';
            
            setTimeout(() => {
                try {
                    const decrypt = new JSEncrypt();
                    decrypt.setPrivateKey(privateKey);
                    
                    const decrypted = decrypt.decrypt(encryptedMessage);
                    
                    if (!decrypted) {
                        throw new Error('Falha na descriptografia. Verifique a chave privada e mensagem.');
                    }
                    
                    // Simulate API request/response
                    const requestData = {
                        encryptedMessage: encryptedMessage.substring(0, 50) + '...',
                        timestamp: new Date().toISOString()
                    };
                    
                    const responseData = {
                        success: true,
                        decryptedMessage: decrypted,
                        messageId: 'msg_' + Math.random().toString(36).substr(2, 9),
                        whatsappStatus: 'sent',
                        timestamp: new Date().toISOString()
                    };
                    
                    document.getElementById('requestLog').textContent = JSON.stringify(requestData, null, 2);
                    document.getElementById('responseLog').textContent = JSON.stringify(responseData, null, 2);
                    document.getElementById('decryptedMessageDisplay').textContent = decrypted;
                    
                    document.getElementById('testResult').classList.remove('hidden');
                    
                    showToast('Teste realizado com sucesso!', 'success');
                    
                    btn.disabled = false;
                    btn.innerHTML = '<svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>Simular Envio';
                } catch (error) {
                    showToast('Erro no teste: ' + error.message, 'error');
                    btn.disabled = false;
                    btn.innerHTML = '<svg class="w-5 h-5 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>Simular Envio';
                }
            }, 800);
        }

        // Copy to Clipboard
        function copyToClipboard(elementId, successMessage) {
            const element = document.getElementById(elementId);
            const text = element.value;
            
            if (!text) {
                showToast('Nada para copiar', 'error');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                showToast(successMessage, 'success');
            }).catch(err => {
                showToast('Erro ao copiar: ' + err.message, 'error');
            });
        }
    </script>
</body>
</html>
